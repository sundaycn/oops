<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" />
<meta name="format-detection" content="telephone=no" />
<meta name="format-detection" content="email=no" />
<meta name="format-detection" content="address=no;">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
<title>修改会员信息</title>
<link rel="stylesheet" type="text/css" href="css/global.css"/>
<link href="skins/minimal/blue.css" rel="stylesheet">
<script type="text/javascript" src="scripts/jquery-1.8.2.min.js"></script>
<script type="text/javascript" src="scripts/app.js"></script>
<script type="text/javascript" src="scripts/icheck.js"></script>
<script type="text/javascript">
var pageUrl = window.location.href.toString(),
	data = {
		"companyId": app.getParam(pageUrl, "companyId"),
		"belongOrgId": app.getParam(pageUrl, "belongOrgId"),
		"weixinOpenId": app.getParam(pageUrl, "weixinOpenId")
	};
	
$(function () {
	document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
		WeixinJSBridge.call('hideOptionMenu');
	});
	
	$('input').iCheck({
		checkboxClass: 'icheckbox_minimal-blue',
		radioClass: 'iradio_minimal-blue'
	});
	
	
	var o = "", sYear = 1949, cYear = (new Date()).getFullYear();
	for (var i = sYear; i <= cYear; i++) {
		if (i == (sYear + Math.round((cYear - sYear) / 2))) {
			o += '<option value='+ i +' selected="selected">'+ i +'</option>'
		} else {
			o += '<option value='+ i +'>'+ i +'</option>'
		}
	}
	$("select[name='c-f-birth-year']").append(o);
	app.loadData(app.basePath +"TmemberCardInfo/tmembercardinfo!queryMemberInfoAjaxp.action", data, setModifyMemberInfo);
	$(".card-form li").css("display", "-webkit-box");
	$(".card-form .btn:first").click(function () {
		data["name"] = $("input[name='c-f-name']").val();
		data["tel"] = $("input[name='c-f-tel']").val();
		data["birthday"] = $("select[name='c-f-birth-year']").val() +"-"+ $("select[name='c-f-birth-month']").val() +"-" + $("select[name='c-f-birth-day']").val();
		data["sex"] = $("input[name='c-f-sex']:checked").val();
		data["address"] = $("input[name='c-f-address']").val();
		app.loadData(app.basePath +"TmemberCardInfo/tmembercardinfo!modifyMemberInfoAjaxp.action", data, function (rs) {
			if (rs.success) {
				alert("您的个人资料已修改。");
				window.location.href="member.html?companyId="+ data['companyId'] +"&belongOrgId="+ data['belongOrgId'] +"&weixinOpenId="+ data['weixinOpenId'];
			}
		});
	});
	$(".card-form .btn-gray").click(function () {
		window.location.href="member.html?companyId="+ data['companyId'] +"&belongOrgId="+ data['belongOrgId'] +"&weixinOpenId="+ data['weixinOpenId'];
	});
});
</script>
</head>
<body class="card" style="background-image:none">
<div id="page" class="theme-default">
	<header style="display:none">
		<hgroup>
            <h2>修改会员信息</h2>
        </hgroup>
	</header>
	<article>
		<form>
			<div class="card-status">亲，完善资料有助于我们更好更快的联系您哦</div>
			<ul class="card-desc card-form">
				<li class="isName"><label>姓名</label><input type="text" class="txt" placeholder="请输入您的真实姓名" name="c-f-name" /></li>
				<li class="isTel"><label>电话</label><input type="text" placeholder="请输入您的有效联系电话" class="txt" name="c-f-tel" /></li>
				<li class="isBirthday">
					<label>生日</label>
					<select class="txt" name="c-f-birth-year">
					</select >年
					<select class="txt" name="c-f-birth-month">
						<option value="01">01</option>
						<option value="02">02</option>
						<option value="03">03</option>
						<option value="04">04</option>
						<option value="05">05</option>
						<option value="06">06</option>
						<option value="07">07</option>
						<option value="08">08</option>
						<option value="09">09</option>
						<option value="10">10</option>
						<option value="11">11</option>
						<option value="12">12</option>
					</select>月
					<select class="txt" name="c-f-birth-day">
						<option value="01">01</option>
						<option value="02">02</option>
						<option value="03">03</option>
						<option value="04">04</option>
						<option value="05">05</option>
						<option value="06">06</option>
						<option value="07">07</option>
						<option value="08">08</option>
						<option value="09">09</option>
						<option value="10">10</option>
						<option value="11">11</option>
						<option value="12">12</option>
						<option value="13">13</option>
						<option value="14">14</option>
						<option value="15">15</option>
						<option value="16">16</option>
						<option value="17">17</option>
						<option value="18">18</option>
						<option value="19">19</option>
						<option value="20">20</option>
						<option value="21">21</option>
						<option value="22">22</option>
						<option value="23">23</option>
						<option value="24">24</option>
						<option value="25">25</option>
						<option value="26">26</option>
						<option value="27">27</option>
						<option value="28">28</option>
						<option value="29">29</option>
						<option value="30">30</option>
						<option value="31">31</option>
					</select>日
				</li>
				<li class="isSex" >
					<label>性别</label>
					<span><input type="radio" name="c-f-sex" value="M"/>男</span>
					<span><input type="radio" name="c-f-sex" value="F"/>女</span>
				</li>
				<li class="isaddress"><label>地址</label><input type="text" placeholder="请输入您的有效联系地址" class="txt" name="c-f-address" /></li>
				<li>
					<a href="javascript:void(0)" class="btn" style="height:25px;line-height:25px;">保存</a>
					<a href="javascript:void(0)" class="btn btn-gray" style="height:25px;line-height:25px;">取消</a>
				</li>
			</ul>
		</form>
	</article>
	<nav>
		<div class="menu">
			<span class="left button" onclick="window.history.back()">后退</span>
			<ul>
				<li><a href="i.html" class="link-index">首页</a></li>
			</ul>
			<span class="right button" onclick="window.location.reload()">刷新</span>
		</div>
	</nav>
</div>
</body>
</html>