<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" />
<meta name="format-detection" content="telephone=no" />
<meta name="format-detection" content="email=no" />
<meta name="format-detection" content="address=no;">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
<title>编辑任务</title>
<link rel="stylesheet" type="text/css" href="../css/global.css"/>
<script type="text/javascript" src="../scripts/jquery-1.8.2.min.js"></script>
<script type="text/javascript" src="../scripts/jquery.autosize.js"></script>
<script type="text/javascript" src="../scripts/app.js"></script>
<script type="text/javascript">
var isAPP = (window.APP && window.APP.login) ? true : false, // 是否通过手机访问
	userName = isAPP ? window.APP.getUserName() : "",    // 获得登录账户的用户名
	userId = isAPP ? window.APP.getUserId() : "", // 获得登录账户的用户id
	pageUrl = window.location.href.toString(),
	data = {},
	setResult = function (rs, handler) {
		if (isAPP) {
			window.APP.hideLoading();
		}
		if (!rs.success && rs.errorCode == "001") {
			if (isAPP) {
				window.APP.login();
			} else {
				alert(rs.message);
			}
		} else {
			if (typeof handler == "function") {
				handler(rs);
			}
		}
	};
	
if (isAPP && !window.APP.isSupportPramas()) {
	app.setData(window.APP.getParams());
}


function doSubmit () {
	if (app.formValidateEmpty()) {
		return false;
	}
	
	app.loadData(app.basePath + "TtaskCooperative/ttaskcooperative!saveAjax.action", {
		"taskTitle": $("#taskTitle").val(),
		"summary": $("#content").val()
	}, function (rs) {
		setResult(rs, function (rs) {
			if (rs.success) {
				window.location.href="./process.html?cleartop=true&taskId="+ rs.message
			}
		});
	});
	
	return false;
}

$(function () {
	$(".eoa-form textarea").focus(function () {
		if ($(this).val() == "输入任务内容。。。") {
			$(this).val("");
		}
	}).bind("keydown keyup",function(){
	   $(this).autosize();
	}).autosize();
	
	// 添加弹出框选择标识
	$(".select, .picker").append('<span class="icon icon-triangle"></span>');
	$(".btn").click(doSubmit);
});
</script>
</head>
<body id="task">
<div id="pageindex" class="theme-default">
	<div class="eoa-form">
		<ul>
			<li>
				<span class="label">任务主题：</span>
				<span class="input text required">
					<input type="text" id="taskTitle" class="txt" value="" />
				</span>
			</li>
			<li>
				<span class="label">任务详细：</span>
				<span class="input textarea">
					<textarea id="content" style="min-height:200px;"></textarea>
				</span>
			</li>
		</ul>
		<br/>
		<p><a href="javascript:void(0)" class="btn">保存并流转处理</a></p>
	</div>
</div>
</body>
</html>